---
title: "Automatically identify communicative acts in parent–child conversations"


bibliography: child-discourse.bib
csl: apa6.csl
document-params: "10pt, letterpaper"

author-information: > 
   \author{Anonymous CogSci Submission}
   
abstract: |
  Over their first years of life, children learn not just the words of their native language, but how to use them to communicate. Becauese manual annotation of communicative acts does not scale to large corpora, our understanding of communicative development is limited to case studies of a few children at a few time points. We present a method for automatic identification of communicative acts using a Hidden Markov Topic Model, and apply it to all the entire CHILDES database. We first describe qualitative changes in parent-child interactions over development, and then use our method to demonstrate two large-scale features of communicative development: (1) children develop an adult-like repertoire of communicative acts months before they develop an adult-like diversity of words, and (2) children's mastery of communicative acts co-incides with the point of highest predictability between parents acts and children's, suggesting that structured interactions may play an important role in language development.
  
keywords: >
  language input, language acquisition, child-directed speech, corpus analysis
    
output: cogsci2016::cogsci_paper
final-submission: \cogscifinalcopy
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=3, fig.height=3, fig.crop = F, 
                      fig.pos = "tb", fig.path='figs/',
                      echo = F, warning = F, cache = T, 
                      message = F, sanitize = T)
# Note: to build, 
options(digits=2)
```

```{r, libraries}
library(png)
library(ggplot2)
library(here)
library(ggridges)
library(scales)
library(tidyboot)
library(xtable)
library(papaja)
library(lme4)
library(lmerTest)
library(ggthemes)
library(broom.mixed)
library(tidyverse)
library(grid)
library(feather)
library(spgs)
library(entropy)
library(glue)
library(viridis)

theme_set(theme_few(base_size = 10))
```

```{r read-data}
childes_htmm_pdwz <- read_feather(here("data/childes_htmm_15.feather")) 
childes_htmm_phi <- read_csv(here("data/phi_vals_all_models.csv"))
dict <- read_csv(here("data/childes_gloss_word_dict.csv"))

mutual_information <- read_csv(here("data/mutual_information_vals.csv"))
conditional_probs <- read_csv(here("data/conditional_probs.csv"))

childes_keep <- childes_htmm_pdwz %>%
  mutate(speaker_role = if_else(speaker_role == "Mother" | speaker_role == "Father",
                                "Parent", speaker_role)) %>%
  group_by(transcript_id, speaker_role) %>%
  summarise(n = n()) %>%
  ungroup() %>%
  complete(speaker_role, transcript_id, fill = list(n = 0)) %>%
  arrange(transcript_id) %>%
  pivot_wider(names_from = "speaker_role", values_from = "n") %>%
  filter(Parent > 10, Target_Child > 10)

childes_htmm_pdwz <- childes_htmm_pdwz %>%
  mutate(speaker_role = if_else(speaker_role == "Mother" | speaker_role == "Father",
                                "Parent", speaker_role)) %>%
  filter(transcript_id %in% childes_keep$transcript_id) %>%
  mutate(age_in_months = floor(target_child_age)) %>%
  filter(age_in_months >= 6) %>%
  mutate(age_bin = cut(age_in_months, breaks = 9))
```

From their first utterances, children are not just producing language but *using* it to communicate. A child who can produce only one-word utterances can nonetheless convey several communicative intentions: using variations in pitch, she can use the word *mama* to identify a person, question possession of an object, or to call for someone's presence [@dore_1975]. From 14 to 30 months of age, children quickly branch out from communicative acts like *requesting*, *protesting*, and *marking an event* to *agreeing to an action*, *stating intent*, and asking and answering a variety of questions [@snow_learning_1996]. These close studies of children's conversations, using rich observations to infer intended meaning in context, show that much of the action of language acquisition happens at the level of what children *mean* to say.

Despite the centrality of communicative goals to even infants' comprehension and production of language [@vouloumanos2012], nearly all of our formal models of language acquire words or syntactic categories rather than communicative expressiveness [e.g. @johnson2007; @siskind1996; although c.f. @bohn2019]. This state of affairs is due in large part because almost all of our large-scale data on language acquisition concern the ages at which children comprehend and produce words or correctly inflect those words according to the grammar of their natural language [@frank2017; @bergmann2018]. We lack a quantitative description of the trajectory of children's communicative capacities, or how they bring these to bear in interactions with their parents and peers.

Describing children's communicative acts on a larger scale, however, is a challenging task. Without nuanced, context-sensitive human coding, communicative acts can be hard to identify. Words are amenable to identification, storage, and tabulation using common computational tools; perhaps due to their ease of use, models of language development have often approached language development at the level of words (i.e., vocabulary learning). The goals and intentions underlying those words are less amenable to such manipulation. We present an approach to modeling the children's communicative acts, working backwards from the words they produce: we model communicative acts as the latent sources from which words emerge, and characterize children's engagement in these acts across development.

Traditionally, studies of communicative acts among children have brought frameworks from adult communication, such as Speech Act theory [@austin_how_1962; @searle_speech_1969] and Conversation Analysis [@sacks_simplest_1974], to bear on children's conversations. While these systems can be useful to characterize children's conversations, young children may not have the same communicative needs as adults—-these may not be relevant distinctions in children's communication. Studying children's communicative acts using a computational model allows us to extract communicative patterns across many children with less a priori specification of what those patterns are. 

Here, we characterize children's growing repertoire of communicative acts using a Hidden Topic Markov Model. This model observes utterances produced by parents and children and attempts to infer common underlying processes—-topics-—that produced them. We first show that this model extracts several communicative acts analogous to those observed in close case studies of children's communication without specifying them top-down. We then show that use of these acts has a developmental trajectory in line with those studies: children's act usage quickly proliferates, and has parent-like diversity by XX months. Further, these acts have distinct developmental trajectories that are in line with prior research. Finally, we show that parents and children engage in these acts contingently within conversations, and that this sequential contingency seems to peak at a fairly young age, when children are engaging in predictable exchanges and social routines.

# Method

## Corpus

We used transcripts of conversations from the Child Language Data Exchange System (CHILDES), a database of child conversation corpora [@macwhinney_childes_2000]. These corpora predominantly record spontaneous conversations between children and their family members, often in the home. We used transcripts from the North American English collection of CHILDES among children 6 months to 60 months old, and filtered these transcripts to include only utterances spoken by the target child or their parents. Overall, our training data included XXX transcripts from XXX children. 

## Model

We used a Hidden Topic Markov Model (HTMM) to extract communicative modes from parent—child conversations [@gruber_hidden_2007]. Topic models represent documents as mixtures of topics, and topics as mixtures of words. For instance, a simple topic model trained on news articles may extract a topic whose distinctive words are "fire", "flood", and "aid" and another whose distinctive words are "speech", "legislation", and "administration". Based on its distribution of words, an article about politicians' provision of disaster relief may be correctly inferred to feature these two topics, among others. Intuitively, the goal of a topic model is to recover the underlying sources—topics—from which the words in a document spring. 

In contrast to a standard topic model, the Hidden Topic Markov Model takes into account the sequential utterance structure of a document, not just its static distribution of words. The HTMM assumes that words within an utterance are of the same topic, and that sequential utterances may be more likely to be of the same topic. It represents topic transitions between utterances in a coarse-grained way: either switch or stay. @gruber_hidden_2007 developed this model and used it to segment machine learning conference papers, showing that the model can distinguish instances of the word "support" in mathematical contexts (describing support vectors) from those in the context of acknowledgments. 

We trained the HTMM on all the utterances in our corpus. Some markers for unintelligible or non-word speech were removed; when this resulted in empty utterances, a 'non-word utterance' token was included to preserve the temporal structure of the dialogue. Typically, function words are removed from corpora before training topic models to aid detection of thematic content. Here, we aim to classify communicative modes underlying utterances rather than thematic topics. We expected function words to be diagnostic of these modes, so included them in our training data.

Topic models require pre-specification of the number of topics. To determine the right number of topics, we trained the model several times with different numbers of topics—5 to 30 topics, in intervals of 5—with Dirichlet parameters of $alpha$ = 1/*k*, where *k* is the number of topics, and $beta$ = 0.01. Each model produced a sequence of the most likely topic assigned to each utterance. Our selection metric was the proportion of other-topic transitions in this sequence: since we aimed to characterize the temporal structure of topic transitions, we wanted to choose a model that had many of transitions between topics rather than long stretches of utterances all assigned to the same topic. However, increasing the number of topics almost necessarily increases the number of other-topic transitions, and may make results harder to interpret as topics proliferate; therefore, we balanced the proportion of other-topic transitions against number of topics. Plotting this proportion across number of topics, we judged 15 topics as an inflection point after which increasing the number of topics had diminishing effect on other-topic transitions; we therefore chose the 15-topic model.

# Results and Discussion

We begin by we show that the model captures some aspects of communicative acts and explore the static distribution of these utterance types. We then examine trajectories of topic use across development among parents and children. Finally, we examine the temporal dynamics of topic use within discourse.

## The structure of communicative acts

After training, the model produces a set of topics with associated probability distributions over words. One can conceive of these topics as bags of words, in which some words will be highly likely to be produced and others will be unlikely to be produced. We extracted the most distinctive words from each topic by taking the difference between the likelihood of each word in a given topic and its average likelihood across all topics (Table \ref{fig:topic_table}). 

Using this probability distribution of words within topics, the model also produces a probability distribution over topics for each utterance in the corpus. Note that this assignment of topic probabilities happens at the utterance level, but temporal structure between utterances is not taken into account. Since we aim to characterize communicative acts and not thematic content or conversational topics, the label 'topic' for these types can be misleading; from here on, we will refer to these types as communicative acts rather than topics.

```{r topic_table, results="asis", fig.env = "figure*", fig.width = 5,  fig.height = 3.5, cap.cols = 2, fig.cap = "The most distinctive words in each topic. Distinctiveness is measured by the difference between a word's likelihood in the given topic and its average likelihood across all topics."}

topics <- c("mental states", "labeling", "counting", "evaluation", "proposed actions",
            "non-present events", "??", "requests", "knowledge questions", 
            "location", "social routines", "backchannels",
            "description", "storytelling", "body routines")

tab <- childes_htmm_phi %>%
  mutate(phi_diff = phi - avg_phi) %>%
  filter(model == "15") %>%
  group_by(topic) %>%
  arrange(desc(phi_diff)) %>%
  slice(1:15) %>%
  mutate(num = 1:15) %>%
  ungroup() %>%
  select(topic, num, word) %>% 
  pivot_wider(names_from = num, values_from = word)  %>%
  mutate(topic_name = topics) %>% select(topic, topic_name, everything())

img <- png::readPNG(here("writing/figs/topic-tab.png"))
grid::grid.raster(img)

```

The most distinctive words of each communicative act in the model, as measured by difference between a word's probability within a type of act and its average probability across all act types, are shown in Table \ref{fig:topic_table}. Although act type assignments are probabilistic, we examined these these most distinctive words and looking at utterances in each act type to produce subjective labels that capture the gist of each automatically identified topic for clarity of exposition. Not all communicative act categories are equally coherent, but even these top N words are illuminating. **SAY SOMETHING ABOUT E.G. COUNTING AND BACK CHANNELS**

```{r snippet_table, results="asis", tab.env = "table"}

childes_htmm_pdwz <- childes_htmm_pdwz %>%
  group_by(transcript_id) %>%
  mutate(lag_topic = lag(max_topic), lead_topic = lead(max_topic)) %>%
  mutate(trigram = paste(lag_topic, max_topic, lead_topic, sep = "_")) %>%
  mutate(second_lead_topic = lead(max_topic, n = 2),
         quadgram = paste(lag_topic, max_topic, 
                          lead_topic, second_lead_topic, sep = "_")) %>%
  ungroup()


snippet <- childes_htmm_pdwz %>%
  filter(quadgram == "5_12_4_5" | lag(quadgram) == "5_12_4_5" | 
           lead(quadgram) == "5_12_4_5" |
           lag(quadgram, n = 2) == "5_12_4_5") %>%
  select(speaker_role, gloss, max_topic, quadgram, 
         target_child_age, transcript_id, utterance_order) %>% 
  filter(transcript_id %in% c(3746,4041,4712,6094),
         !(transcript_id == 6094 & utterance_order < 174),
         !(transcript_id == 4712 & utterance_order < 209)) %>%
  mutate(utterance_order = rep(1:4,4), target_child_age = floor(target_child_age)) %>%
  select(max_topic, speaker_role, gloss, target_child_age, utterance_order) %>% 
  mutate(speaker_role = if_else(speaker_role == "Parent", "P: ", "C: ")) %>%
  unite(act, speaker_role, gloss, sep = "") %>%
  mutate(target_child_age = glue("{target_child_age} months")) %>%
  pivot_wider(names_from = target_child_age, values_from = act) %>%
  select(-utterance_order) %>%
  select(max_topic, contains("23"), contains("39"), #skipped 53
         contains("57")) %>%
  rename(act = max_topic) 

snippet_tab <- xtable(snippet, label = "tab:snippet_table",
         hline.after = c(-1, 0),
         caption = "Three examples of the same communicative act sequence (5, 12, 4, 5) in conversations from different children at different ages. Though they involve different topical content, they follow a similar communicative pattern: a suggestion or request regarding action and location; an affirmative or negative response; an evaluative statement or question; and another suggestion regarding action and location.")
print(snippet_tab, type = "latex", comment = F, table.placement = "tb", 
       floating = TRUE,
       floating.environment = "table*",
       include.rownames = FALSE)
```

To further validate our method, we considered sets of exchanges that share the same communicative act sequence but vary in their participants and content. Table \ref{tab:snippet_table} shows three such exchanges between parents and their 23-, 39-, and 57-month-olds. Each exchange begins with a proposed action which receives a back channel, the action is evaluated, and a new action is proposed. Across these three, the words in each act are different, and sometimes even of opposite valence (e.g. "okay" vs. "no no"). The role of the speaker is also--the same act can be produced by both parents and children. Nonetheless, there is a family resemblance across them. 

Bolstered by the coherence of communicative act categories and the resemblance of their sequences, we next provide first qualitative and then quantitative descriptions of parents' and children's production of these acts over development.

## Use of communicative acts over development

```{r entropy-par-child}

num_topics <- n_distinct(childes_htmm_pdwz$max_topic)
topic_nums <- c(1:num_topics)
topic_probs <- paste0("topic_", topic_nums)

topic_entropies <- read_csv(here("data/childes_topic_entropies.csv"))
word_entropies <- read_csv(here("data/childes_word_entropies.csv"))

```


```{r branching_out_plot, fig.height = 3.5, fig.width = 7, fig.env = "figure*", fig.align = "left", fig.cap = "The proportion of communicative acts of each type produced by children and parents across development."}
topics <- c("mental states", "labeling", "counting", "evaluation", "proposed actions",
            "absent events", "misc", "requests", "knowledge questions", 
            "location", "social routines", "backchannels",
            "description", "storytelling", "body routines")

branching <- childes_htmm_pdwz %>%
  mutate(age_bin = cut(age_in_months, 20, labels = FALSE),
         age_bin = (54/20)*age_bin + 6,
         speaker_role = if_else(speaker_role == "Target_Child", "Child", "Parent"),
         speaker_role = factor(speaker_role, levels = c("Child", "Parent"))) %>%
  group_by(age_bin, speaker_role) %>%
  count(max_topic) 

par_child_topic_probs <- childes_htmm_pdwz %>%
  group_by(transcript_id, speaker_role) %>%
  count(max_topic) %>%
  ungroup() %>%
  complete(transcript_id, speaker_role, max_topic, fill = list(n = 0)) %>% 
  group_by(transcript_id, speaker_role) %>%
  mutate(sum = sum(n)) %>% 
  ungroup() %>%
  mutate(prob = n / sum) %>% 
  select(transcript_id, speaker_role, max_topic, prob) %>%
  pivot_wider(names_from = speaker_role, values_from = prob)

nested_probs <- par_child_topic_probs %>%
  group_by(max_topic) %>%
  nest()

lapply(nested_probs, cor.test(.$Parent, .$Target_Child))


topic_probs_cor_plot <- par_child_topic_probs
  ggplot(aes(x = Parent, y = Target_Child)) +
  geom_point() +
  geom_smooth() +
  facet_wrap(~max_topic)

#par_child_topic_count_correlation <- cor.test(branching_wide$Child, branching_wide$Parent)

branching_annotations <- tibble(max_topic = 1:num_topics,
                                topic_name = topics,
                                age_bin = c(60, 30, 48, 53, 50, 53, 50,
                                            38, 38, 35, 27, 50, 38, 55, 40),
                                n = c(.95, .9, .8, .74, .64, .54, .48, .50, 
                                      .45, .36, .3, .2, .13, .07, .02),
                                speaker_role = "Parent")

ggplot(branching, aes(x = age_bin, y = n, group = max_topic, 
             fill = as.factor(max_topic))) +
  geom_area(position = "fill", color = "black") +
  facet_wrap(~speaker_role) +
  theme(legend.position = "none") + 
  geom_text(aes(label = topic_name), size = 2.5, color = "white", hjust = 1,
            data = branching_annotations) +
  labs(x = "age (months)", y = "communicative act proportion")
```

Children's use of communicative acts changes drastically as they grow (Figure \ref{fig:branching_out_plot}). Early on, children's utterances are predominantly backchannels, interjections, and affirmations or negations (e.g., "yeah", "no", "uh huh"). By around 20 months of age, social routines such as greetings and naming family members (e.g., "hi", "bye", "mommy") displace backchannels to become a substantial part of children's repertoire. Around the same age, an increasing proportion of children's utterances direct attention to or label things in the environment (e.g., "what's that?", "there's a..."). Parents also increasingly use these labeling utterances when their children are around 15-30 months old; after about 30 months, these utterances diminish in both parent and child speech. 

Across our observed age range, both parents and children consistently increase the proportion of their statements about mental states and testimony (e.g., "know", "think", "said"). This is consistent with prior work showing an increase in mental state talk over the 3- to 5-year-old age range, which is correlated with theory of mind task performance [@hughes1998; @de-villiers2000]. It may also reflect growing mastery of the complex syntax required to produce embedded constructions about mental states (e.g., "She thinks it will rain.").

One way to characterize the diversity of communicative acts a person engages in is to measure the entropy of their communicative acts. Overall, parents' communicative acts had higher entropy than children's. Children's communicative act entropy increased drastically over development between 6 and around 24 months, and remained relatively stable across the rest of our age range, as shown in Figure \ref{fig:entropy_plot}. 

Our automatically-identified communicative acts are therefore capturing some capacity that becomes more adult-like across development. [more description / perhaps some stats] [this paragraph could be moved to part 2.]

Beyond becoming more complex across development, the ability to engage in a variety of communicative acts might reasonably be expected to correlate with other measures of language ability. Indeed, @snow_learning_1996 found that the number of speech act types children use correlates highly with the number of word types they use, but does not consistently correlate with mean length of utterance (MLU). We replicate these findings here: children's number of communicative act types produced correlate with their word types produced (*stats*) and does not consistently correlate with MLU (*stats*). Children's diversity of communicative acts also correlates with their parents' diversity of communicative acts, even when controlling for age (*stats*)

Notably, children at the lowest end of our age range start with at least some representation of several communicative act types, and expand on their repertoire rapidly. They also reach adult-like levels of diversity in communicative act production quickly, by around 36 months—before they reach comparably adult-like levels of vocabulary production, as shown in Figure \ref{fig:entropy_plot}. 

Parents' and children's communicative usage patterns echo one another somewhat [...] [Potential alignment at young ages etc ...]

```{r word_types}

n_topics <- topic_entropies %>%
  group_by(age, transcript_id, speaker_role) %>%
  summarise(n_topics = n())

n_mlu_topics <- childes_htmm_pdwz %>%
  filter(speaker_role == "Target_Child") %>%
  group_by(age_in_months, transcript_id) %>%
  summarise(mlu = mean(num_tokens)) %>%
  left_join(n_topics %>% filter(speaker_role == "Target_Child"), by = c("transcript_id", "age_in_months" = "age"))

word_counts <- childes_htmm_pdwz %>%
  select(gloss, transcript_id, age_in_months, speaker_role) %>%
  mutate(word = strsplit(as.character(gloss), " ")) %>% 
  unnest(word) %>%
  group_by(age_in_months, transcript_id, speaker_role, word) %>%
  summarise(n = n()) %>%
  ungroup() %>%
  filter(word != "")

num_word_types <- word_counts %>%
  group_by(transcript_id, age_in_months, speaker_role) %>%
  summarise(n_word_types = n())

n_mlu_words_entropies <- n_mlu_topics %>%
  left_join(num_word_types %>% filter(speaker_role == "Target_Child"), by = c("transcript_id", "speaker_role","age_in_months"))

```


```{r entropy-model}
type_entropies <- topic_entropies %>%
  mutate(entropy_type = "Communicative Act") %>%
  bind_rows(word_entropies %>% mutate(entropy_type = "Productive Vocabulary")) 

entropy_model <- lmer(entropy ~ speaker_role * log(age) * entropy_type +
       (speaker_role|transcript_id),
     data = type_entropies) 

```

```{r entropy_plot, fig.width = 3.5, fig_height = 4.5, fig.cap = "Entropy of topics produced by children, mothers and fathers over development.", fig.pos="tb"}
type_annotations <- tibble(age = 40, entropy = c(6, 4),
                           speaker_role = c("Parent", "Target_Child"),
                           plot_label = c("Parent", "Child"),
                           entropy_type = "Productive Vocabulary")

ggplot(type_entropies, aes(age, entropy, color = speaker_role, 
                           group = interaction(entropy_type, speaker_role))) +
  geom_jitter(alpha = 0.3, size = 0.1) +
  geom_smooth() +
  #stat_smooth(formula = y ~ log(x), aes(linetype = "speaker_role")) +
  ylab("Entropy") +
  xlab("Age") +
  ggtitle("Entropy of communicative acts and words") +
  theme(legend.position = "none") +
  annotate("text", x = 10, y = 6.5, label = "words", size = 5) +
  annotate("text", x = 10, y = .5, label = "acts", size = 5) +
  geom_text(aes(label = plot_label), data = type_annotations)

```

## Part 3: Dynamics of communicative acts over development

Over development, children gain the ability to engage in more structured dialogue, eventually becoming able to respond appropriately and contingently to their conversational partner [@bruner1985]. To characterize the temporal dynamics of communicative acts in conversation, we turn our attention to the transitions between utterances in parent-child conversations. One way to measure how contingent parents' and children's utterances are on each other is to calculate their mutual information, a measure of how much knowing one piece of information (a prior utterance) reduces uncertainty about another (the current utterance). However, discourse with adult-like structure may not maximize mutual information: because discourse has recursive structure, raising topics and closing them in an embedded way, it may not be highly regular at the level of utterance-to-utterance transitions [cite??]. Mutual information between sequential utterances is maximized when utterances are highly predictable based only on the utterance prior, and can be dampened either because contingency is weak or because higher-order structure is at play.

To calculate the mutual information between parents' and children's utterances, we use the full distribution of communicative act probabilities for each utterance produced by the model. These probabilities are averaged within turns; that is, if a child produced four utterances in a row, the probabilities are averaged to produce one probability per act type per turn. We then compute conditional probabilities for each current act type given each prior act type. These conditional probabilities are used to calculate mutual information. We calculate mutual information values for the parent's utterance given the child's utterance, the child's utterance given the parent's utterance, and the child's utterance given their own prior utterance (their own last turn).

```{r mi, fig.cap = "Mutual information between parents and children's communicative acts over development."}
mi_annotations <- tibble(age_bin = c(20, 26, 26), 
                         type = c("Child | Child", "Parent | Child",
                                  "Child | Parent"),
                         mi = c(.3, .2, .08))

mutual_information %>%
  mutate(type = case_when(type == "child_given_child" ~ "Child | Child",
                          type == "parent_given_child" ~ "Parent | Child",
                          type == "child_given_parent" ~ "Child | Parent")) %>%
  ggplot(aes(age_bin, mi, color = type, group = type)) +
  geom_pointrange(aes(ymin = ci_lower, ymax = ci_upper)) +
  geom_line() +
  ylab("Mutual Information (bits)") +
  xlab("Age") +
  ggtitle("") +
  theme(legend.position = "none") +
  geom_text(aes(label = type), data = mi_annotations)
```

When children are young, mutual information is highest between the child's current utterance and their own last utterance [\ref{fig:mi}]. One way to interpret this is that the child is on their own conversational track, steered less by what their conversational partner just said than what they themselves said prior. By around 24 months, this tendency lessens considerably, but children remain more predictable based on their own prior utterances than their parents' utterances across our age range.

Interestingly, there seems to be an increase in mutual information in all three of our measures—-(parents $\vert$ children, children $\vert$ parents, and children $\vert$ children—-from the beginning of our age range peaking at about 14-20 months, after which mutual information declines. Though this is an exploratory finding, it points to the possibility that parents and children interact most contingently when children are still quite young. That is, at the youngest ages, there may be low mutual information between parents and children's sequential utterances because of disorganized interaction; mutual information may then increase as sequences become more orderly, but discourse is not necessarily structured on longer timescales; and mutual information may fall again as discourse structure emerges that is not captured in sequential utterance transitions.

# Discussion

In this paper, we present an method for characterizing children's communicative acts on a large scale. In doing so, we gain the ability to examine the communication of more children in more contexts and across a wider age range than afforded by hand coding, and to examine patterns of usage that only become clear across such a wide range of data. 

We also lose nuance in the conversational context and non-verbal aspects of communication. Children can achieve communicative goals even before they can use language to do so: they can use gestures and vocalizations both to request a desired object and to call a person's attention to something in the environment [@bates_acquisition_1975].  Studies of children's early one-word utterances demonstrate that they can use the same word to fulfill multiple communicative goals [@dore_1975].

Nevertheless, the communicative acts extracted by the model show regularities at multiple levels that suggest they reflect communicative function. Children start off with a few act types at the beginning of our age range, and quickly branch out into others as they grow. Different act types show different developmental trajectories: children produce lots of interjections and backchannels early on, soon extending into social routines; parents and children increasingly engage in directing attention and labeling when children are 2 to 3 years old, and less so thereafter; talk about mental states and testimony increases among children and parents consistently across our age range. Children's diversity of communicative acts is correlated with their vocabulary, and with their parent's diversity of communicative acts. Finally, parents and children produce these acts contingently, depending on the prior utterance, and our findings suggest a period of heightened contingency before children reach an adult-like diversity of these acts. Overall, our approach offers a way to take advantage of large corpora of child conversations in the study of children's use of communicative acts across development.


```{r conditional_prob_plot, fig.env = "figure*", fig.width = 7, fig.height = 3, cap.cols = 2, fig.cap = "(A) "}
conditional_probs %>%
  mutate(age_median = if_else(age_bin <= 18, "younger", "older")) %>% 
  pivot_longer(cols = topic_probs, names_to = "current_topic", values_to = "prob") %>%
  ggplot(aes(x=prior_topic, y=current_topic, fill=log(prob))) + 
  geom_tile() +
  facet_grid(speaker~age_median, scales = "free") +
  scale_fill_gradientn(colours = viridis(256, option = "D"))
```

# References 

```{r}
# References will be generated automatically by Pandoc and included here.
# The following code is some latex to format the bibliography. Do not remove it.
```

\setlength{\parindent}{-0.1in} 
\setlength{\leftskip}{0.125in}
\noindent